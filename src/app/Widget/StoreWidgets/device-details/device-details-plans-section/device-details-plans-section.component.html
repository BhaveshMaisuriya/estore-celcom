<!-- Section Plans Start  -->
<div id="step2" *ngIf="isProjectStar === false; else starContainer">
  <div>
    <section
      class="u-section"
      *ngIf="DevicePagePurachaseTypeCLicked === 'Device Bundle'"
    >
      <section
        class="u-section ng-tns-c11-3 ng-star-inserted"
        *ngIf="DevicePagePurachaseTypeCLicked === 'Device Bundle'"
      >
        <div class="section__inner">
          <div class="section__content is-container">
            <div class="section2 dev-dtl-plan-heading">
              <div class="section_index_container">
                <span class="section_index">3</span>
              </div>
              <div class="">
                <h2
                  *ngIf="!isMviva"
                  class="device_outerrow__left device_detail_left_link"
                >
                  Select your Celcom Mobile Principal plan
                </h2>
              </div>
              <div
                *ngIf="!isMviva"
                class="device__outerrow__right dev-dtl-right-link"
              ></div>
            </div>
            <!-- <div class="section__inner">
            <div class="section__content">
              <div [hidden]="!isLogin" *ngIf="!isMviva" class="u-grid-row">
                <div class="max-supplimentary-info-container">
                  <div class="max-supplimentary-image"><img src="./assets/img/notifications.svg"
                      class="supplimentary-notification"></div>
                  <div class="supplimentary-notification-content">You are entitled to select 1 Principal line and up to
                    <span>{{((noOfLinesAllowed > 0) && (noOfLinesAllowed < 5)) ? noOfLinesAllowed : (noOfLinesAllowed >= 5) ? 5 : 0}}</span>
                    supplementary line(s).</div>
                </div> -->
            <!-- <div  *ngIf="noOfLinesAllowed<0" class="max-supplimentary-info-container">
                        <div class="max-supplimentary-image"><img src="./assets/img/notifications.svg" class="supplimentary-notification"></div>
                        <div class="supplimentary-notification-content">You are not entitled for Supplimentary line(s).</div>
                      </div> -->
            <!-- </div>
              <div class="u-grid-row is-equal-height supplimentary-margin" [ngClass]="{'disableClass': cobpLoading}">

                <div class="u-grid-col is-col-mobile-p-6 is-supplimentary-col-tablet-p-2">
                  <div *ngIf="!isMviva" class="plan__name_detail supplimentary_box_width">
                    <div class="plan__details supplimentary_box_height"
                      [ngClass]="{'is-selectedPlan': principleLineOnly && !buyNoPlan}"
                      (click)='SuppLinesSelection($event,"PrincipleLineOnly")'>
                      <div class="plan__details__description supplimentary_line_description">
                        <p class="">No Supplementary</p>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="u-grid-col is-col-mobile-p-6 is-supplimentary-col-tablet-p-2"
                  *ngFor="let supplimentaryline of supplimentarylines;let i=index"
                  [class.disableClass]="supplimentaryline.id > noOfLinesAllowed || isXpaxSelected === true || this.isKardashianPlanSelected === true || isNeptune === false">
                  <div *ngIf="!isMviva && !isDealer" class="plan__name_detail supplimentary_box_width">
                    <div class="plan__details supplimentary_box_height"
                      [ngClass]="{'is-selectedPlan':(supplimentaryline.id && activeSuppLines[supplimentaryline.id] && activeSuppLines[supplimentaryline.id].isActive && !principleLineOnly && !buyNoPlan)}"
                      (click)='SuppLinesSelection($event,supplimentaryline.id);'>
                      <div class="plan__details__description supplimentary_line_description">
                        <p><span class="supp_id"> +{{supplimentaryline.id}}</span>{{supplimentaryline.label}}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="max-subsidy-info-container" *ngIf = '!principleLineOnly'>
            <div class="subsidy-notification-content">Subscribe up to <span>{{this.chosenSuplimentaryLines}}</span> supplimentary line(s) to get maximum subsidy of <b class="rm-font">RM</b>
              <span class="normal-font">
                   <span class="rm-font">{{(totalSubsidyAmount) | number : '1.2-2'}}</span>. Device price after subsidy will be </span><span class="bold-font">
                     <span>RM{{(devicePriceWithSubsidy < '0.00' ? 0 : devicePriceWithSubsidy) | number : '1.2-2'}}</span></span></div>
          </div>
          <div *ngIf="!isMviva" class="supplimentary-selection-info">Option(s) available for your Celcom Mobile Principal<span *ngIf="isXpaxSelected === true">/XPAX</span> line based
            on the <span class="bold-font">
                <span>{{chosenSuplimentaryLines === 'PrincipleLineOnly' ? 0 : chosenSuplimentaryLines}}</span> Supplementary line(s) selected</span></div> -->
          </div>
        </div>
      </section>
      <div class="section__inner">
        <div class="section__content is-container">
          <section
            class="u-section"
            *ngIf="
              DeviceDetailsBundleResponse.length > 0 &&
              DevicePagePurachaseTypeCLicked === 'Device Bundle' &&
              !isMviva
            "
          >
            <div class="section__inner">
              <div class="section__content">
                <div class="u-grid-row is-equal-height plans-section-alignment">
                  <ng-container
                    *ngFor="
                      let item of DeviceDetailsBundleResponse;
                      let i = index
                    "
                  >
                    <div
                      class="u-grid-col is-col-mobile-p-6 is-supplimentary-col-tablet-p-2 plan-margin ng-tns-c4-0 ng-star-inserted"
                      *ngIf="
                        (item.is_xpax === 'false' || item.is_xpax === false) &&
                        ((isPromotion === true && promotionPlan === item.sku) ||
                          isPromotion === false)
                      "
                    >
                      <div class="plan__name_detail">
                        <div
                          class="hat__container"
                          *ngIf="item.is_premium_plan"
                        >
                          <img src="../assets/img/Drop_3/vip.svg" />PREMIUM PLAN
                        </div>
                        <div
                          class="plan__details"
                          [ngClass]="{
                            disableClass: cobpLoading,
                            'kardashian-radius': item.is_premium_plan,
                            'first-plan-border':
                              DeviceDetailsXpaxPlanResponse.length > 0
                          }"
                          (click)="
                            SelectPlan(
                              item.name,
                              item.sku,
                              item.PlanMonthlyPay,
                              item,
                              i,
                              $event
                            )
                          "
                          [class.is-selectedPlan]="
                            (item.name &&
                              activeStateList[item.name] &&
                              activeStateList[item.name].isActive &&
                              isActive) ||
                            (isPromotion === true && promotionPlan === item.sku)
                          "
                          [class.kardashian-plan-selected]="
                            ((item.name &&
                              activeStateList[item.name] &&
                              activeStateList[item.name].isActive &&
                              isActive) ||
                              (isPromotion === true &&
                                promotionPlan === item.sku)) &&
                            item.is_premium_plan
                          "
                          [class.disableClass]="
                            PlanEligibility(item.sku) ||
                            disablePlan ||
                            cobpLoading
                          "
                        >
                          <div class="plan__details__description">
                            <p [innerHTML]="item.productText"></p>
                            <p [innerHTML]="item.keyFiguresText"></p>
                            <p
                              class="plan_price"
                              [innerHTML]="item.keyText"
                            ></p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </ng-container>
                  <p
                    class="empty-space"
                    *ngIf="
                      DeviceDetailsBundleResponse.length > 4 &&
                      DeviceDetailsXpaxPlanResponse.length >= 2
                    "
                  ></p>
                  <div
                    class="u-grid-col is-col-mobile-p-6 is-supplimentary-col-tablet-p-2 margin-for-desktop"
                    *ngFor="
                      let item of DeviceDetailsXpaxPlanResponse;
                      let i = index
                    "
                  >
                    <ng-container
                      *ngIf="
                        (item.is_xpax === 'true' || item.is_xpax === true) &&
                        !hideXpax &&
                        isPromotion === false
                      "
                    >
                      <div class="plan__name_detail">
                        <div
                          class="hat__container"
                          *ngIf="item.is_premium_plan"
                        >
                          <img src="../assets/img/Drop_3/vip.svg" />PREMIUM PLAN
                        </div>
                        <div
                          class="plan__details xpax-border"
                          [ngClass]="{
                            disableClass: cobpLoading,
                            'kardashian-radius': item.is_premium_plan
                          }"
                          (click)="
                            SelectPlan(
                              item.name,
                              item.sku,
                              item.PlanMonthlyPay,
                              item,
                              i,
                              $event
                            )
                          "
                          [class.is-xpax-selectedPlan]="
                            item.name &&
                            activeStateList[item.name] &&
                            activeStateList[item.name].isActive &&
                            isActive
                          "
                          [class.kardashian-plan-selected]="
                            item.name &&
                            activeStateList[item.name] &&
                            activeStateList[item.name].isActive &&
                            isActive &&
                            item.is_premium_plan
                          "
                        >
                          <div class="plan__details__description">
                            <p [innerHTML]="item.productText"></p>
                            <p [innerHTML]="item.keyFiguresText"></p>
                            <p
                              class="plan_price"
                              [innerHTML]="item.keyText"
                            ></p>
                          </div>
                        </div>
                      </div>
                    </ng-container>
                  </div>
                </div>
              </div>
            </div>
          </section>
          <section
            class="u-section"
            *ngIf="
              DeviceDetailsBundleResponse.length < 1 &&
              DeviceDetailsXpaxPlanResponse.length > 0 &&
              !isMviva
            "
          >
            <div class="section__inner">
              <div class="section__content">
                <div class="u-grid-row is-equal-height">
                  <div
                    class="u-grid-col is-col-mobile-p-6 is-supplimentary-col-tablet-p-2 margin-for-desktop"
                    *ngFor="
                      let item of DeviceDetailsXpaxPlanResponse;
                      let i = index
                    "
                  >
                    <ng-container
                      *ngIf="
                        (item.is_xpax === 'true' || item.is_xpax === true) &&
                        !hideXpax &&
                        isPromotion === false
                      "
                    >
                      <div class="plan__name_detail">
                        <div
                          class="plan__details xpax-border"
                          [ngClass]="{ disableClass: cobpLoading }"
                          (click)="
                            SelectPlan(
                              item.name,
                              item.sku,
                              item.PlanMonthlyPay,
                              item,
                              i,
                              $event
                            )
                          "
                          [class.is-xpax-selectedPlan]="
                            item.name &&
                            activeStateList[item.name] &&
                            activeStateList[item.name].isActive &&
                            isActive
                          "
                        >
                          <div class="plan__details__description">
                            <p [innerHTML]="item.productText"></p>
                            <p [innerHTML]="item.keyFiguresText"></p>
                            <p
                              class="plan_price"
                              [innerHTML]="item.keyText"
                            ></p>
                          </div>
                        </div>
                      </div>
                    </ng-container>
                  </div>
                </div>
              </div>
            </div>
          </section>
          <section
            class="u-section"
            [ngClass]="{ 'mviva-plan': isMviva }"
            *ngIf="
              DeviceDetailsBundleResponse.length > 0 &&
              DevicePagePurachaseTypeCLicked === 'Device Bundle' &&
              isMviva
            "
          >
            <div class="section__inner">
              <div class="section__content">
                <div class="u-grid-row is-equal-height plans-section-alignment">
                  <ng-container
                    *ngFor="
                      let item of DeviceDetailsBundleResponse;
                      let i = index
                    "
                  >
                    <div
                      class="u-grid-col is-col-mobile-p-6 is-col-tablet-p-2 plan-margin ng-tns-c4-0 ng-star-inserted"
                    >
                      <ng-container
                        *ngIf="
                          item.is_xpax === 'false' || item.is_xpax === false
                        "
                      >
                        <div class="plan__name_detail">
                          <div
                            class="hat__container"
                            *ngIf="item.is_premium_plan"
                          >
                            <img src="../assets/img/Drop_3/vip.svg" />PREMIUM
                            PLAN
                          </div>
                          <div
                            class="plan__details"
                            [ngClass]="{
                              disableClass: cobpLoading,
                              'kardashian-radius': item.is_premium_plan
                            }"
                            (click)="
                              SelectPlan(
                                item.name,
                                item.sku,
                                item.PlanMonthlyPay,
                                item,
                                i,
                                $event
                              )
                            "
                            [class.is-selectedPlan]="
                              item.name &&
                              activeStateList[item.name] &&
                              activeStateList[item.name].isActive &&
                              isActive
                            "
                            [class.kardashian-plan-selected]="
                              item.name &&
                              activeStateList[item.name] &&
                              activeStateList[item.name].isActive &&
                              isActive &&
                              item.is_premium_plan
                            "
                            [class.disableClass]="
                              PlanEligibility(item.sku) ||
                              disablePlan ||
                              cobpLoading
                            "
                          >
                            <div class="plan__details__description">
                              <p
                                class="plan_text"
                                [innerHTML]="item.productText"
                              ></p>
                              <p
                                class="plan_figure"
                                [innerHTML]="item.keyFiguresText"
                              ></p>
                              <p
                                class="plan_price"
                                [innerHTML]="item.keyText"
                              ></p>
                            </div>
                          </div>
                        </div>
                      </ng-container>
                    </div>
                  </ng-container>
                </div>
              </div>
            </div>
          </section>
          <section
            class="u-section"
            [ngClass]="{ 'mviva-plan': isMviva }"
            *ngIf="
              DeviceDetailsXpaxPlanResponse.length > 0 &&
              DevicePagePurachaseTypeCLicked === 'Device Bundle' &&
              isMviva
            "
          >
            <div class="section__inner">
              <div class="section__content">
                <div class="u-grid-row is-equal-height plans-section-alignment">
                  <ng-container
                    *ngFor="
                      let item of DeviceDetailsXpaxPlanResponse;
                      let i = index
                    "
                  >
                    <div
                      class="u-grid-col is-col-mobile-p-6 is-col-tablet-p-2 margin-for-desktop"
                    >
                      <ng-container
                        *ngIf="
                          (item.is_xpax === 'true' || item.is_xpax === true) &&
                          !hideXpax
                        "
                      >
                        <div class="plan__name_detail">
                          <div
                            class="hat__container"
                            *ngIf="item.is_premium_plan"
                          >
                            <img src="../assets/img/Drop_3/vip.svg" />PREMIUM
                            PLAN
                          </div>
                          <div
                            class="plan__details"
                            [ngClass]="{
                              disableClass: cobpLoading,
                              'kardashian-radius': item.is_premium_plan
                            }"
                            (click)="
                              SelectPlan(
                                item.name,
                                item.sku,
                                item.PlanMonthlyPay,
                                item,
                                i,
                                $event
                              );
                              _deviceDataService.publishUpdateStep(2)
                            "
                            [class.is-selectedPlan]="
                              item.name &&
                              activeStateList[item.name] &&
                              activeStateList[item.name].isActive &&
                              isActive
                            "
                            [class.kardashian-plan-selected]="
                              item.name &&
                              activeStateList[item.name] &&
                              activeStateList[item.name].isActive &&
                              isActive &&
                              item.is_premium_plan
                            "
                          >
                            <div class="plan__details__description">
                              <p [innerHTML]="item.productText"></p>
                              <p [innerHTML]="item.keyFiguresText"></p>
                              <p
                                class="plan_price"
                                [innerHTML]="item.keyText"
                              ></p>
                            </div>
                          </div>
                        </div>
                      </ng-container>
                    </div>
                  </ng-container>
                </div>
              </div>
            </div>
          </section>
          <!-- <div class="selection_text">
            <img src="../assets/img/Drop_3/eligible-icon.png" alt="eligible" class="remove_image_in_center">
            <p><span class="eligible-text">You are eligible to select mobile number(s) for 1 Principal and 2 Supplementary
                Line(s) <b>Principal</b> and <b>2 Supplementary Line(s)</b></span><br>
                <span class="eligible-sub-text" >Subscribe up to 2 supplementary lines to get maximum subsidy of <b>RM300.00</b>.Device price after subsidy will be <strong>RM2,888.00</strong></span>
                </p>
          </div> -->
          <div
            *ngIf="
              maxLineArray.length > 0 &&
              DevicePagePurachaseTypeCLicked === 'Device Bundle' &&
              !isEnterprise()
            "
          >
            <div *ngFor="let element of maxLineArray">
              <div class="selection_text" *ngIf="element.sku === planSku">
                <img
                  src="../assets/img/Drop_3/eligible-icon.png"
                  alt="eligible"
                  class="remove_image_in_center"
                />
                <p>
                  <span class="eligible-text"
                    >You are eligible to select mobile number(s) for 1
                    <b>Principal</b> and
                    <b>{{ element.maxLines }} Supplementary Line(s)</b></span
                  ><br />
                  <span class="eligible-sub-text"
                    >Subscribe up to 2 supplementary lines to get maximum
                    subsidy of <b>RM300.00</b>.Device price after subsidy will
                    be <strong>RM2,888.00</strong></span
                  >
                </p>
              </div>
            </div>
          </div>

          <!-- <div class="teaser__link reframe_more_details" id="moreDetailsP">
          <a class="c-link--default device_detail_link_style" data-css="c-link" (click)="MoreDetails();">
            <span class="link__icon icon is-icon-arrow-down device_detail_arrow-heading"
              [ngClass]="{'is-arrow-active':is_icon_active}"></span>
            <span class="link__content device_detail_link">Plan details</span>
          </a>
        </div> -->
        </div>
      </div>
    </section>
    <!-- choose pricing options section start-->
    <!-- <section class="u-section sectionize is-bg-color-white"
    *ngIf="(data?.basic_details?.is_easy_phone === 1) && DevicePagePurachaseTypeCLicked === 'Easyphone' && (isRentClicked || isOwnClicked)">
    <div class="section__inner">
      <div class="section__content is-container">
        <div class="section_index_container"><span class="section_index">3</span></div>
        <p class="price_options_title">MEGA<sup>TM</sup></p>
        <div id="pricing-option" class="u-grid-row select_pricing_option" [ngClass]="{'disableClass': cobpLoading}">
          <div *ngIf='data && data.basic_details && data.basic_details.is_rent'
            class="u-grid-col is-col-mobile-p-3 mobile-width pricing_options_inner easy-phone-tabs"
            (click)="RentClicked()"
            [ngClass]="{'is-selected_option' : isRentClicked, 'is-rent-selected' : isRentClicked, 'is-col-tablet-p-8' : data && !data.basic_details.is_own, 'is-col-tablet-p-4' : data && data.basic_details && data.basic_details.is_rent && data.basic_details.is_own }">
            Rent</div>
          <div *ngIf='data && data.basic_details && data.basic_details.is_own'
            class="u-grid-col is-col-mobile-p-3 mobile-width is-col-tablet-p-8 pricing_options_inner inner_pricing_border easy-phone-tabs last-tab"
            (click)="OwnClicked()"
            [ngClass]="{'is-selected_option' : isOwnClicked, 'is-col-tablet-p-8' : data && !data.basic_details.is_rent, 'is-col-tablet-p-4' : data && data.basic_details && data.basic_details.is_rent && data.basic_details.is_own}">
            Own</div>
        </div>
        <div class="rent_own_text_main">
          <p *ngIf="isRentClicked" class="rent_text_title">EasyPhone™ Rent</p>
          <p *ngIf="isRentClicked" class="rent_desc">Rent a phone easily with low monthly fees!*</p>
          <p *ngIf="isOwnClicked" class="rent_text_title">EasyPhone™ Own</p>
          <p *ngIf="isOwnClicked" class="rent_desc">Get a phone with affordable monthly fees. Upgrade to new phone at
            any time during your contract*.</p>
          <p *ngIf="isBundleClicked" class="rent_text_title">Device Bundle</p>
        </div>
        <div class="u-grid-row is-equal-height rent-box_mobile" *ngIf="isRentClicked"
          [ngClass]="{'center-align-box': DeviceDetailsRentResponse.length <= 2}">
          <ng-container *ngFor="let item of DeviceDetailsRentResponse;let i=index">
            <div
              class="u-grid-col is-col-mobile-p-12-device is-col-tablet-p-6 is-col-desktop-l-4 margin-for-desktop"
              *ngIf="(item.sku !== 'FGP' && data.basic_details.sku === 'Samsung-Galaxy-S10') || (item.sku !== '' && data.basic_details.sku !== 'Samsung-Galaxy-S10')">
              <div class="easy_phone_deatils" [ngClass]="{'disableClass': cobpLoading}"
                (click)="SelectPlan(item.name, item.sku,item.PlanMonthlyPay, item,i,$event);_deviceDataService.publishRentPrice(item.rentData);"
                [class.is-selected-method]="(item.name && activeStateList[item.name] && activeStateList[item.name].isActive) && isActive">
                <div class="easy_phone_deatils_top"
                  [ngClass]="{'easy-phone-selected-border': (item.name && activeStateList[item.name] && activeStateList[item.name].isActive) && isActive}">
                  <p>Rent phone at <span class="details_top_inner">RM{{item.rentData}}</span>/ month</p>
                  <p>with <span class="details_top_color">{{item.productText}} {{item.keyFiguresText}}</span></p>
                </div>
                <div class="easy_phone_deatils_bottom">
                  <div class="bottom_left"
                    [ngClass]="{'selected-plan-box': (item.name && activeStateList[item.name] && activeStateList[item.name].isActive) && isActive}">
                    <div>
                      <p>Total</p>
                      <p>RM{{item.totalAmountWithRent}}</p>
                      <p>/ month</p>
                    </div>
                  </div>
                  <div class="bottom_right">
                    <div class="phone_price">
                      <p>RM{{item.rentData}} </p>
                      <p>Phone</p>
                    </div>
                    <div class="phone_plus_plan">
                      <span>+</span>
                      <p> &nbsp;</p>
                    </div>
                    <div class="phone_price">
                      <p>{{item.keyText}}</p>
                      <p>Pass</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ng-container>
        </div>
        <div class="u-grid-row is-equal-height rent-box_mobile" *ngIf="isOwnClicked"
          [ngClass]="{'center-align-box': DeviceDetailsOwnResponse.length <= 2}">
          <ng-container *ngFor="let item of DeviceDetailsOwnResponse;let i=index">
            <div
              class="u-grid-col is-col-mobile-p-12-device is-col-tablet-p-6 is-col-desktop-l-4 margin-for-desktop"
              *ngIf="(item.sku !== 'FGP' && data.basic_details.sku === 'Samsung-Galaxy-S10') || (item.sku !== '' && data.basic_details.sku !== 'Samsung-Galaxy-S10')">
              <div class="easy_phone_deatils" [ngClass]="{'disableClass': cobpLoading}"
                (click)="SelectPlan(item.name, item.sku,item.PlanMonthlyPay, item,i,$event);_deviceDataService.publishOwnPrice(item.ownData);"
                [class.is-selected-method]="(item.name && activeStateList[item.name] && activeStateList[item.name].isActive) && isActive">
                <div class="easy_phone_deatils_top"
                  [ngClass]="{'easy-phone-selected-border': (item.name && activeStateList[item.name] && activeStateList[item.name].isActive) && isActive}">
                  <p>Own phone at
                    <span class="details_top_inner">RM{{item.ownData}}</span>/ month</p>
                  <p>with
                    <span class="details_top_color">{{item.productText}} {{item.keyFiguresText}}</span>
                  </p>
                </div>
                <div class="easy_phone_deatils_bottom">
                  <div class="bottom_left"
                    [ngClass]="{'selected-plan-box': (item.name && activeStateList[item.name] && activeStateList[item.name].isActive) && isActive}">
                    <div>
                      <p>Total</p>
                      <p>RM{{item.totalAmountWithOwn}}</p>
                      <p>/ month</p>
                    </div>
                  </div>
                  <div class="bottom_right">
                    <div class="phone_price">
                      <p>RM{{item.ownData}} </p>
                      <p>Phone</p>
                    </div>
                    <div class="phone_plus_plan">
                      <span>+</span>
                      <p> &nbsp;</p>
                    </div>
                    <div class="phone_price">
                      <p>{{item.keyText}}</p>
                      <p>Pass</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </ng-container>
        </div>
        <p *ngIf="isRentClicked || isOwnClicked" class="not_desc">
          <strong>Note: Autobilling with credit card is mandatory for Easyphone subscription.<br/>
            Credit cards issued by AEON, Affin, Alliance, Ambank, BSN, CIMB, Citibank, Hong Leong,
            Maybank, OCBC, Public Bank, Bank Rakyat, RHB, Standard Chartered and UOB are acceptable.</strong>
        </p>
        <section class="u-section" *ngIf="DeviceDetailsBundleResponse.length > 0 && isBundleClicked && !isEasyPhone">
          <div class="section__inner">
            <div class="section__content">
              <div class="u-grid-row is-equal-height device-bundle-plans">
                <div class="u-grid-col is-col-mobile-p-6 is-col-tablet-p-2 ng-tns-c4-0 ng-star-inserted plan-margin-16"
                  *ngFor="let item of DeviceDetailsBundleResponse;let i=index">
                  <ng-container *ngIf="item.is_xpax === 'false' || item.is_xpax === false">
                    <div class="plan__name_detail">
                      <div class="plan__details" [ngClass]="{'disableClass': cobpLoading}"
                        (click)="SelectPlan(item.name, item.sku,item.PlanMonthlyPay, item,i,$event);_deviceDataService.publishUpdateStep(2);_deviceDataService.publishBundlePrice(item.bundleData);_deviceDataService.publishBundleUpfrontPrice(item.bundleUpfrontData);"
                        [class.is-selectedPlan]="(item.name && activeStateList[item.name] && activeStateList[item.name].isActive) && isActive">
                        <div class="plan__details__description">
                          <p>First™ <span [innerHTML]="item.productText"></span></p>
                          <p [innerHTML]="item.keyFiguresText"></p>
                          <p class="plan_price_bundle" [innerHTML]="item.keyText"></p>
                        </div>
                      </div>
                    </div>
                  </ng-container>
                </div>
              </div>
            </div>
          </div>
        </section>
        <div class="teaser__link reframe_more_details" id="moreDetailsP">
          <a class="c-link--default device_detail_link_style" data-css="c-link" (click)="MoreDetails();">
            <span class="link__icon icon is-icon-arrow-down device_detail_arrow-heading"
              [ngClass]="{'is-arrow-active':is_icon_active}"></span>
            <span class="link__content device_detail_link">More details</span>
          </a>
        </div>
      </div>
    </div>
  </section> -->
    <div
      id="plan-details"
      *ngIf="DevicePagePurachaseTypeCLicked !== 'Device Only'"
    >
      <section class="show-more-details" [@slideInOut]="showMoreDetails">
        <ng-container *ngIf="TableComparisonResponse != null">
          <section
            class="u-section is-bg-color-white"
            [attr.data-analytics-region]="dataAnalyticsRegion"
          >
            <div class="section__inner">
              <div class="section__content is-container">
                <h2 class="plan-features">Plan Features</h2>
                <div
                  data-js-module="accordion"
                  data-js-options='{"context": "tabs", "closeClass": "", "openClass": "is-active", "toggleContentVisibility": false, "openIndex": 0, "singleOpen": true, "tabMode": true}'
                >
                  <ul class="c-tabs table-tabs-head">
                    <ng-container
                      *ngFor="
                        let item of TableComparisonResponse;
                        let i = index
                      "
                    >
                      <li
                        class="tabs__tab text-center"
                        [ngClass]="{
                          'is-active': item.tabName === SelectedTab
                        }"
                        (click)="OnTabSelect(item, i)"
                        [attr.data-analytics-region]="item.tabName"
                      >
                        <a
                          class="is-default-cursor"
                          [innerHTML]="item.tabName"
                        ></a>
                      </li>
                    </ng-container>
                  </ul>
                </div>
              </div>
            </div>
          </section>
          <section
            class="u-section has-section-padding has-border"
            style="padding-top: 0;"
          >
            <div class="section__inner">
              <div class="section__content is-container">
                <div
                  data-js-module="accordion"
                  data-js-options='{"context": "tabs", "closeClass": "", "openClass": "is-active", "toggleContentVisibility": false, "openIndex": 0, "singleOpen": true, "tabMode": true}'
                >
                  <!-- <div></div> -->
                  <section class="u-section">
                    <div class="section__inner">
                      <div class="section__content">
                        <div class="c-plan-comparison">
                          <div
                            class="plan-comparison__list"
                            data-js-module="accordion"
                            data-js-options='{"closeClass": "", "openClass": "is-active", "toggleContentVisibility": false, "context": "plan-comparison"}'
                          >
                            <ng-container
                              *ngFor="
                                let item of PlanData.tabData;
                                let i = index
                              "
                            >
                              <div
                                class="plan-comparison__list__item"
                                *ngIf="
                                  (item.sku === promotionPlan &&
                                    isPromotion === true) ||
                                  isPromotion === false
                                "
                                [ngClass]="{
                                  'is-plan-one':
                                    PlanData.tabData.length == 1 ||
                                    isPromotion === true
                                }"
                              >
                                <div
                                  class="plan-comparison__list__item__header"
                                  [attr.href]="item.AtrHref"
                                  (click)="accordianOpen(i)"
                                >
                                  <div
                                    *ngIf="
                                      item.is_xpax === 'false' ||
                                      item.is_xpax === false
                                    "
                                    class="plan-comparison__list__item__level-indicator {{
                                      item.indicatorClass
                                    }}"
                                  ></div>
                                  <div
                                    *ngIf="
                                      item.is_xpax === 'true' ||
                                      item.is_xpax === true
                                    "
                                    class="plan-comparison__list__item__level-indicator is-level-xpax"
                                  ></div>
                                  <div
                                    class="plan-comparison__list__item__header__level-name"
                                    [innerHTML]="item.productText"
                                  ></div>
                                  <div
                                    class="plan-comparison__list__item__header__key-figures"
                                    [innerHTML]="item.keyFiguresText"
                                  ></div>
                                  <h4
                                    *ngIf="
                                      item.is_xpax === 'false' ||
                                      item.is_xpax === false
                                    "
                                    class="plan-comparison__list__item__header__key"
                                    [innerHTML]="item.keyText"
                                  ></h4>
                                  <h4
                                    *ngIf="
                                      item.is_xpax === 'true' ||
                                      item.is_xpax === true
                                    "
                                    class="plan-comparison__list__item__header__key plan-comparison__list__item__header__key_xpax"
                                    [innerHTML]="item.keyText"
                                  ></h4>
                                </div>
                                <div
                                  class="plan-comparison__list__item__content"
                                  data-js-item="accordion-content-plan-comparison"
                                  id="rm-{{ i }}"
                                  data-js-height="308"
                                  aria-expanded="false"
                                >
                                  <ul>
                                    <ng-container
                                      *ngFor="let detail of item.tableInfo"
                                    >
                                      <li
                                        *ngIf="
                                          item.is_xpax === 'false' ||
                                          item.is_xpax === false
                                        "
                                        class="plan-comparison__list__item__content__detail"
                                        [ngClass]="{
                                          'is-highlighted':
                                            detail.heighlight == '1'
                                        }"
                                      >
                                        <span
                                          class="plan-comparison__list__item__content__detail__description"
                                          [innerHTML]="detail.headline"
                                        ></span>
                                      </li>
                                      <!-- </ng-container> -->
                                      <!-- <ng-container *ngIf="item.is_xpax" *ngFor="let detail of item.TableInfo"> -->
                                      <li
                                        *ngIf="
                                          item.is_xpax === 'true' ||
                                          item.is_xpax === true
                                        "
                                        class="plan-comparison__list__item__content__detail detail-xpax"
                                        [ngClass]="{
                                          'is-highlighted':
                                            detail.heighlight == '1'
                                        }"
                                      >
                                        <span
                                          class="plan-comparison__list__item__content__detail__description"
                                          [innerHTML]="detail.headline"
                                        ></span>
                                      </li>
                                    </ng-container>
                                  </ul>
                                </div>
                              </div>
                            </ng-container>
                          </div>
                        </div>
                      </div>
                    </div>
                  </section>
                </div>
              </div>
            </div>
          </section>
        </ng-container>
      </section>
    </div>
    <!-- lifestyle addon component -->
    <app-lifestyle-plans *ngIf="isPromotion === true" [addOnData]="addOnData">
    </app-lifestyle-plans>
  </div>
</div>
<ng-template #starContainer>
  <div id="step2">
    <div>
      <!-- choose pricing options section start-->
      <section
        class="u-section sectionize is-bg-color-white"
        *ngIf="
          DevicePagePurachaseTypeCLicked === 'Device Bundle' ||
          (data?.basic_details?.is_easy_phone === 1 &&
            DevicePagePurachaseTypeCLicked === 'Easyphone' &&
            (isRentClicked || isOwnClicked))
        "
      >
        <div class="section__inner">
          <div class="section__content is-container">
            <div class="section_index_container">
              <span class="section_index">3</span>
            </div>
            <p class="price_options_title">Choose Pricing Option</p>
            <div class="tab-margin">
              <!-- Begin of BASE PLAN -->
              <div class="u-grid-row rent-box_mobile">
                <div *ngFor="let pass of data.choose_plan" class="u-grid-col is-col-mobile-p-12-device is-col-tablet-p-6 is-col-desktop-l-4">
                    <app-plan-card (click)="planIdentifierSelection(pass.sku)" [autoExpanded]="true"
                      [selected]="selectedPlanIdentifier === pass.sku || pass.name === undefined" [pricetag]="basePlans[0]?.keyText"
                      [title]="pass.name ? basePlans[0]?.name +' '+ pass.name : basePlans[0]?.name" [collapsibleFooter]="true"
                      [footerTemplate]="pass.offer ? footer : null"
                      [description]="(pass.name === undefined && basePlans[0].offer) ? basePlans[0].offer : null"
                      [collapseButtonTemplate]="collapseButtonTemplate">
                      <ng-template #collapseButtonTemplate></ng-template>
                      <ng-template #footer>
                        <div [innerHTML]="pass.offer | safeHtml"></div>
                      </ng-template>
                    </app-plan-card>
                  </div>
              </div>
              <!-- End of BASE PLAN -->
              <!-- Begin EasyPhone -->
              <ng-container
                *ngIf="
                  data?.basic_details?.is_easy_phone === 1 &&
                  DevicePagePurachaseTypeCLicked === 'Easyphone' &&
                  (isRentClicked || isOwnClicked)
                "
              >
                <p class="choose_plan_selection">
                  Choose EasyPhone Own at a low monthly fee by adding a Pass to
                  your base plan
                </p>

                <div
                  *ngIf="
                    (isEasyPhoneOwn$ | async) && (isEasyPhoneRent$ | async)
                  "
                  id="pricing-option"
                  class="u-grid-row select_pricing_option"
                  [ngClass]="{ disableClass: cobpLoading }"
                >
                  <div
                    *ngIf="
                      data && data.basic_details && data.basic_details.is_own
                    "
                    class="u-grid-col is-col-mobile-p-3 mobile-width pricing_options_inner easy-phone-tabs"
                    (click)="OwnClicked()"
                    [ngClass]="{
                      'is-selected_option': isOwnClicked,
                      'is-rent-selected': isOwnClicked,
                      'is-col-tablet-p-8': data && !data.basic_details.is_rent,
                      'is-col-tablet-p-4':
                        data &&
                        data.basic_details &&
                        data.basic_details.is_rent &&
                        data.basic_details.is_own
                    }"
                  >
                    EasyPhone™ Own
                  </div>
                  <div
                    *ngIf="
                      data && data.basic_details && data.basic_details.is_rent
                    "
                    class="u-grid-col is-col-mobile-p-3 mobile-width pricing_options_inner easy-phone-tabs is-col-tablet-p-8 inner_pricing_border last-tab"
                    (click)="RentClicked()"
                    [ngClass]="{
                      'is-selected_option': isRentClicked,
                      'is-col-tablet-p-8': data && !data.basic_details.is_own,
                      'is-col-tablet-p-4':
                        data &&
                        data.basic_details &&
                        data.basic_details.is_rent &&
                        data.basic_details.is_own
                    }"
                  >
                    EasyPhone™ Rent
                  </div>
                </div>
                <p></p>

                <ng-container
                  *ngIf="(easyphoneContractPeriods$ | async)?.length > 0"
                >
                  <p class="choose_plan_selection" *ngIf="selectedPlanIdentifier === plansInfo.gb_pass_sku">
                    Choose contract period and the pass you preferred
                  </p>
                  <p class="choose_plan_selection" *ngIf="selectedPlanIdentifier === plansInfo.speed_pass_sku">
                    Enjoy Unlimited internet for as long as you like without worries based on your payment period plan selection
                  </p>
                  <div
                    [ngClass]="{ disableClass: cobpLoading }"
                    data-js-module="accordion"
                    data-js-options='{"context": "tabs", "closeClass": "", "openClass": "is-active", "toggleContentVisibility": false, "openIndex": 0, "singleOpen": true, "tabMode": true}'
                  >
                    <div class="c-tabs is-full-width">
                      <ng-container
                        *ngFor="let item of easyphoneContractPeriods$ | async"
                      >
                        <div
                          class="c-tabs__tab"
                          [ngClass]="{
                            'is-active':
                              item ===
                              (easyphoneSelectedContractPeriods$ | async),
                            'is-disabled': !isContractAvailable(
                              item,
                              easyphoneAvailableContractPeriods$ | async
                            )
                          }"
                          (click)="OnContractTabSelected(item)"
                        >
                          {{ item }} months
                        </div>
                      </ng-container>
                    </div>
                  </div>
                </ng-container>
                <!-- text for easy phone rent and own tags end-->

                <div
                  class="u-grid-row is-equal-height rent-box_mobile"
                  [ngClass]="{
                    'center-align-box': getDataToShow(isRentClicked).length <= 2
                  }"
                >
                  <ng-container
                    *ngFor="
                      let item of getDataToShow(isRentClicked);
                      let i = index
                    "
                  >
                    <ng-container
                      *ngIf="item.basePlanIdentifier === selectedPlanIdentifier && 
                        getDevicePriceFromContract(
                          easyphoneSelectedContractPeriods$ | async,
                          item.sku,
                          devicePrices$ | async
                        ) as price
                      "
                    >
                    <div 
                      class="u-grid-col is-col-mobile-p-12-device is-col-tablet-p-6 is-col-desktop-l-4 ep-cards"
                    >
                      <app-plan-card
                        (click)="
                          SelectPlan(
                            item.name,
                            item.sku,
                            item.PlanMonthlyPay,
                            item,
                            i,
                            $event
                          );
                          _deviceDataService.publishRentPrice(price)
                        "
                        [autoExpanded]="false" [selected]="planSku == item.sku" [pricetagTemplate]="pricetagTemplate"
                        [description]="selectedPlanIdentifier === plansInfo.speed_pass_sku ? item.offer : null" 
                        [title]="item.PlanName"
                        [collapsibleFooter]="false"
                        [collapseButtonTemplate]="selectedPlanIdentifier === plansInfo.speed_pass_sku ? null : collapseButtonTemplate"
                        [footerTemplate]="footer" class="cursor-pointer">
                        <ng-template #pricetagTemplate>
                          <span class="f-size-14"> Own phone at
                            <span class="pricetag">{{item.keyText}}</span>/month
                          </span>
                        </ng-template>
                        <ng-template #collapseButtonTemplate>{{ item.keyFiguresText }}</ng-template>
                        <ng-template #footer>
                          <div class="bottom_left">
                              <div>
                                <p>
                                  Total
                                  <span class="details_top_total">
                                    RM{{
                                      calculateTotalPay(
                                        (basePlan$ | async).PlanMonthlyPay,
                                        item.PlanMonthlyPay,
                                        price
                                      )
                                    }}</span
                                  >
                                  / month
                                </p>
                              </div>
                            </div>
                            <div class="bottom_right">
                              <div class="phone_price">
                                <p>{{ (basePlan$ | async)?.keyText }}</p>
                                <p class="price_options_title">Mega&trade;</p>
                              </div>
                              <div class="phone_plus_plan">
                                <span>+</span>
                                <p>&nbsp;</p>
                              </div>
                              <div class="phone_price">
                                <p>{{ item.keyText }}</p>
                                <p>Pass</p>
                              </div>
                              <div class="phone_plus_plan">
                                <span>+</span>
                                <p>&nbsp;</p>
                              </div>
                              <div class="phone_price">
                                <p>RM{{ price }}</p>
                                <p>Phone</p>
                              </div>
                            </div>
                        </ng-template>
                      </app-plan-card>
                    </div>
                    </ng-container>
                  </ng-container>
                </div>
              </ng-container>
              <!-- End of EasyPhone -->
              <!-- Begin Device Bundle -->
              <ng-container
                *ngIf="DevicePagePurachaseTypeCLicked === 'Device Bundle'"
              >
                <p>
                  Select the right pricing option for you by adding a Pass to
                  the base plan.
                </p>

                <p>
                  Enjoy seamless High-Speed Internet for all your entainment needs
                </p>

                <div class="u-grid-row is-equal-height rent-box_mobile">
                  <ng-container
                    *ngFor="
                      let item of getDataToShow(undefined);
                      let i = index
                    "
                  >
                    <ng-container *ngIf="item.basePlanIdentifier === selectedPlanIdentifier">
                      <app-plan-card
                      (click)="
                        SelectPlan(
                          item.name,
                          item.sku,
                          item.PlanMonthlyPay,
                          item,
                          i,
                          $event
                        )
                      "
                        [autoExpanded]="false"
                        [selected]="planSku == item.sku" 
                        [pricetagTemplate]="pricetagTemplate"
                        [description]="selectedPlanIdentifier === plansInfo.speed_pass_sku ? item.offer : null" 
                        [title]="item.PlanName"
                        [collapsibleFooter]="false"
                        [collapseButtonTemplate]="selectedPlanIdentifier === plansInfo.speed_pass_sku ? null : collapseButtonTemplate"
                        [footerTemplate]="footer" class="db-cards is-col-mobile-p-12-device is-col-tablet-p-6 is-col-desktop-l-4">
                        <ng-template #pricetagTemplate>
                          <span *ngIf="selectedPlanIdentifier === plansInfo.speed_pass_sku"> +
                            <span class="pricetag">{{item.keyText}}</span>/month</span>
                          <span *ngIf="selectedPlanIdentifier === plansInfo.gb_pass_sku"> Total
                            <span class="pricetag">{{item.keyText}}</span>/month</span>
                        </ng-template>
                        <ng-template #collapseButtonTemplate>{{ item.keyFiguresText }}</ng-template>
                        <ng-template #footer>
                          <div class="easy_phone_deatils_bottom">
                            <div class="plan_desc">
                              <p class="get_device m-0 text-center">
                                Get device at
                                <span class="plan-text">RM{{getDevicePrice(item.sku) | number: "1.0-2"}}</span>
                              </p>
                            </div>
                          </div>
                        </ng-template>
                      </app-plan-card>
                    </ng-container>
                  </ng-container>
                </div>
              </ng-container>
              <!-- End of Device Bundle -->
              <p class="plan-notes">
                You have selected:
                <span class="plan-selected"
                  >{{ totalDataLimit }}GB Internet and Unlimited Calls to All
                  Networks</span
                >
                <br />
                <span class="_has_margin"
                  >Total monthly commitment:
                  <span class="plan-total-monthly"
                    >RM{{ totalPlanMonthly | number: "1.0-2" }}</span
                  >
                </span>
              </p>
              <div
                *ngIf="
                  maxLineArray.length > 0 &&
                  DevicePagePurachaseTypeCLicked === 'Device Bundle' &&
                  !isEnterprise()
                "
              >
                <div *ngFor="let element of maxLineArray">
                  <div class="selection_text" *ngIf="element.sku === planSku">
                    <img
                      src="../assets/img/Drop_3/eligible-icon.png"
                      alt="eligible"
                      class="remove_image_in_center"
                    />
                    <p>
                      <span class="eligible-text"
                        >You are eligible to select mobile number(s) for 1
                        <b>Principal</b> and
                        <b
                          >{{ element.maxLines }} Supplementary Line(s)</b
                        ></span
                      ><br />
                      <!-- <span class="eligible-sub-text" >Subscribe up to 2 supplementary lines to get maximum subsidy of <b>RM300.00</b>.Device price after subsidy will be <strong>RM2,888.00</strong></span> -->
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <!-- /.tab-margin -->
          </div>
        </div>
      </section>
      <!-- lifestyle addon component -->
      <app-lifestyle-plans *ngIf="isPromotion === true" [addOnData]="addOnData">
      </app-lifestyle-plans>
    </div>
  </div>
</ng-template>
<ng-container *ngIf="IsDispalySwitchingPurchaseTypeTabPopup">
  <app-losing-supplementary-line-popup
    [popupType]="popupType"
    (OnContinueSupplementaryPopup)="onContinueSwitchingPurchaseTypeTab($event)"
    (OnLeaveSupplementaryPopup)="onCancellingSwitchingPurchaseTypeTab($event)"
  ></app-losing-supplementary-line-popup>
</ng-container>
<app-table-comparison></app-table-comparison>
